<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Booking Buttons</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .btn {
            background: #d4af37;
            color: black;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn:hover {
            background: #b8941f;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ Debug Booking Management Functions</h1>
        
        <div class="test-section">
            <h3>1. Test Database Connection</h3>
            <button class="btn" onclick="testDatabase()">Test Database</button>
            <div id="dbLog" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>2. Test Session</h3>
            <button class="btn" onclick="testSession()">Test Session</button>
            <div id="sessionLog" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>3. Test Booking Details</h3>
            <input type="number" id="bookingId" placeholder="Enter Booking ID" value="1">
            <button class="btn" onclick="testBookingDetails()">Get Booking Details</button>
            <div id="bookingLog" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>4. Test Status Update</h3>
            <input type="number" id="updateBookingId" placeholder="Enter Booking ID" value="1">
            <select id="newStatus">
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="cancelled">Cancelled</option>
            </select>
            <button class="btn" onclick="testStatusUpdate()">Update Status</button>
            <div id="statusLog" class="log"></div>
        </div>
        
        <div class="test-section">
            <h3>5. Test Booking Update</h3>
            <button class="btn" onclick="testBookingUpdate()">Test Booking Update</button>
            <div id="updateLog" class="log"></div>
        </div>
    </div>

    <script>
        function log(elementId, message) {
            const logElement = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        async function testDatabase() {
            log('dbLog', 'Testing database connection...');
            try {
                const response = await fetch('Backend/test_database_connection.php');
                const text = await response.text();
                log('dbLog', 'Response: ' + text);
            } catch (error) {
                log('dbLog', 'Error: ' + error.message);
            }
        }

        async function testSession() {
            log('sessionLog', 'Testing session...');
            try {
                const response = await fetch('Backend/test_session.php');
                const data = await response.json();
                log('sessionLog', 'Session data: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                log('sessionLog', 'Error: ' + error.message);
            }
        }

        async function testBookingDetails() {
            const bookingId = document.getElementById('bookingId').value;
            log('bookingLog', `Testing booking details for ID: ${bookingId}`);
            try {
                const response = await fetch(`Backend/Admin/get_booking_details.php?id=${bookingId}`);
                const data = await response.json();
                log('bookingLog', 'Response: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                log('bookingLog', 'Error: ' + error.message);
            }
        }

        async function testStatusUpdate() {
            const bookingId = document.getElementById('updateBookingId').value;
            const status = document.getElementById('newStatus').value;
            log('statusLog', `Testing status update for ID: ${bookingId}, Status: ${status}`);
            try {
                const response = await fetch('Backend/update_bookings_status.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        booking_id: bookingId,
                        status: status,
                        table: 'home_bookings'
                    })
                });
                const data = await response.json();
                log('statusLog', 'Response: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                log('statusLog', 'Error: ' + error.message);
            }
        }

        async function testBookingUpdate() {
            log('updateLog', 'Testing booking update...');
            try {
                const response = await fetch('Backend/Admin/update_booking.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        id: 1,
                        customer_name: 'Test User',
                        customer_email: 'test@example.com',
                        customer_phone: '1234567890',
                        room_type: 'Deluxe Room',
                        check_in_date: '2025-08-01',
                        check_out_date: '2025-08-02',
                        num_guests: 2,
                        num_rooms: 1,
                        total_amount: 1000,
                        status: 'pending',
                        special_instructions: 'Test update'
                    })
                });
                const data = await response.json();
                log('updateLog', 'Response: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                log('updateLog', 'Error: ' + error.message);
            }
        }
    </script>
</body>
</html> 