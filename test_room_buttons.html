<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Room Buttons</title>
    <style>
        .room-card {
            border: 1px solid #ccc;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            max-width: 300px;
        }
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn-edit {
            background: #d4af37;
            color: #000;
        }
        .btn-delete {
            background: #dc3545;
            color: #fff;
        }

        /* Completely hide scrollbar while keeping functionality */
        #editRoomModal > div {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
            overflow-y: auto;
            max-height: 90vh;
        }

        #editRoomModal > div::-webkit-scrollbar {
            width: 0px; /* Chrome, Safari, Opera */
            background: transparent;
        }

        #editRoomModal > div::-webkit-scrollbar-track {
            background: transparent;
        }

        #editRoomModal > div::-webkit-scrollbar-thumb {
            background: transparent;
        }

        #editRoomModal > div::-webkit-scrollbar-thumb:hover {
            background: transparent;
        }
    </style>
</head>
<body>
    <h1>Test Room Edit and Delete Buttons</h1>
    
    <div class="room-card" data-room-type="Pearl Signature Room">
        <h3>Pearl Signature Room</h3>
        <p>Price: $20,695/night</p>
        <p>Floor: 1, 25 Rooms, 5 Available</p>
        <button class="btn btn-edit" onclick="openEditModal('Pearl Signature Room')">Edit</button>
        <button class="btn btn-delete" onclick="deleteRoom('Pearl Signature Room')">Delete</button>
    </div>
    
    <div class="room-card" data-room-type="Deluxe Room">
        <h3>Deluxe Room</h3>
        <p>Price: $3,240/night</p>
        <p>Floor: 1, 140 Rooms, 5 Available</p>
        <button class="btn btn-edit" onclick="openEditModal('Deluxe Room')">Edit</button>
        <button class="btn btn-delete" onclick="deleteRoom('Deluxe Room')">Delete</button>
    </div>

    <!-- Edit Room Modal -->
    <div id="editRoomModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); overflow-y: auto;">
      <div style="background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 500px; max-height: 90vh; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #d4af37 #f0f0f0;">
        <h2 style="color: #333; margin-bottom: 20px;">Edit Room Details</h2>
        <form id="editRoomForm">
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Room Type:</label>
            <input type="text" id="editRoomType" readonly style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9;">
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Price per Night ($):</label>
            <input type="number" id="editPrice" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Total Rooms:</label>
            <input type="number" id="editTotalRooms" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Available Rooms:</label>
            <input type="number" id="editAvailableRooms" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Floor Number:</label>
            <input type="number" id="editFloor" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Status:</label>
                         <select id="editStatus" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
               <option value="Available">Available</option>
               <option value="Fully Booked">Fully Booked</option>
               <option value="Maintenance">Maintenance</option>
             </select>
           </div>
           <div style="margin-bottom: 15px;">
             <label style="display: block; margin-bottom: 5px; font-weight: bold;">Room Type:</label>
             <select id="editRoomTypeSelect" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" onchange="handleEditRoomTypeChange()">
               <option value="Pearl Signature Room">Pearl Signature Room</option>
               <option value="Deluxe Room">Deluxe Room</option>
               <option value="Premium Room">Premium Room</option>
               <option value="Executive Room">Executive Room</option>
               <option value="Luxury Suite">Luxury Suite</option>
               <option value="Family Suite">Family Suite</option>
               <option value="Others">Others</option>
             </select>
           </div>
           <div style="margin-bottom: 15px;" id="editCustomRoomTypeDiv" style="display: none;">
             <label style="display: block; margin-bottom: 5px; font-weight: bold;">Custom Room Type Name:</label>
             <input type="text" id="editCustomRoomType" placeholder="Enter new room type name..." style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
           </div>
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Description:</label>
            <textarea id="editDescription" rows="3" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"></textarea>
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Additional Notes:</label>
            <textarea id="editNotes" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Any additional notes about this room type..."></textarea>
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Amenities:</label>
            <textarea id="editAmenities" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" placeholder="List of amenities included..."></textarea>
          </div>
          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Special Features:</label>
            <textarea id="editFeatures" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Special features or highlights..."></textarea>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Maintenance Notes:</label>
            <textarea id="editMaintenance" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Any maintenance notes or requirements..."></textarea>
          </div>
          <div style="text-align: right; position: sticky; bottom: 0; background: #fff; padding-top: 10px; border-top: 1px solid #eee;">
            <button type="button" onclick="closeEditModal()" style="padding: 8px 16px; margin-right: 10px; border: 1px solid #ddd; background: #f8f9fa; border-radius: 4px; cursor: pointer;">Cancel</button>
            <button type="submit" style="padding: 8px 16px; background: #d4af37; color: #000; border: none; border-radius: 4px; cursor: pointer;">Save Changes</button>
          </div>
        </form>
      </div>
    </div>

    <script>
        // Handle edit modal room type selection change
        function handleEditRoomTypeChange() {
            const editRoomTypeSelect = document.getElementById('editRoomTypeSelect');
            const editCustomRoomTypeDiv = document.getElementById('editCustomRoomTypeDiv');
            const editCustomRoomTypeInput = document.getElementById('editCustomRoomType');
            
            if (editRoomTypeSelect.value === 'Others') {
                editCustomRoomTypeDiv.style.display = 'block';
                editCustomRoomTypeInput.required = true;
                editCustomRoomTypeInput.focus();
            } else {
                editCustomRoomTypeDiv.style.display = 'none';
                editCustomRoomTypeInput.required = false;
                editCustomRoomTypeInput.value = '';
            }
        }

        // Modal functions
        function openEditModal(roomType) {
            const modal = document.getElementById('editRoomModal');
            const roomCard = document.querySelector(`[data-room-type="${roomType}"]`);
            
            if (!roomCard) {
                alert('Room data not found');
                return;
            }
            
            // Extract current values
            const priceElement = roomCard.querySelector('p');
            const currentPrice = parseFloat(priceElement.textContent.replace('Price: $', '').replace('/night', '').replace(',', ''));
            
            // Populate form fields
            document.getElementById('editRoomType').value = roomType;
            document.getElementById('editPrice').value = currentPrice;
            document.getElementById('editTotalRooms').value = 25;
            document.getElementById('editAvailableRooms').value = 5;
            document.getElementById('editFloor').value = 1;
            document.getElementById('editStatus').value = 'Available';
            document.getElementById('editRoomTypeSelect').value = roomType;
            document.getElementById('editDescription').value = '';
            document.getElementById('editNotes').value = '';
            document.getElementById('editAmenities').value = '';
            document.getElementById('editFeatures').value = '';
            document.getElementById('editMaintenance').value = '';
            document.getElementById('editCustomRoomTypeDiv').style.display = 'none';
            document.getElementById('editCustomRoomType').value = '';
            
            modal.style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('editRoomModal').style.display = 'none';
        }

        // Handle form submission
        document.getElementById('editRoomForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const editRoomTypeSelect = document.getElementById('editRoomTypeSelect');
            const editCustomRoomTypeInput = document.getElementById('editCustomRoomType');
            
            let roomType = editRoomTypeSelect.value;
            
            // If "Others" is selected, use the custom room type name
            if (roomType === 'Others') {
                roomType = editCustomRoomTypeInput.value.trim();
                if (!roomType) {
                    alert('Please enter a custom room type name.');
                    editCustomRoomTypeInput.focus();
                    return;
                }
            }
            
            const price = parseFloat(document.getElementById('editPrice').value);
            const totalRooms = parseInt(document.getElementById('editTotalRooms').value);
            const availableRooms = parseInt(document.getElementById('editAvailableRooms').value);
            const floor = parseInt(document.getElementById('editFloor').value);
            const status = document.getElementById('editStatus').value;
            const description = document.getElementById('editDescription').value;
            const notes = document.getElementById('editNotes').value;
            const amenities = document.getElementById('editAmenities').value;
            const features = document.getElementById('editFeatures').value;
            const maintenance = document.getElementById('editMaintenance').value;
            
            try {
                const response = await fetch('Backend/Admin/edit_room.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        room_type: roomType,
                        base_price: price,
                        total_rooms: totalRooms,
                        available_rooms: availableRooms,
                        floor_number: floor,
                        status: status,
                        description: description,
                        notes: notes,
                        amenities: amenities,
                        features: features,
                        maintenance: maintenance
                    })
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    alert('Room updated successfully!');
                    closeEditModal();
                    location.reload();
                } else {
                    alert('Error: ' + result.message);
                }
            } catch (error) {
                console.error('Error updating room:', error);
                alert('Failed to update room. Please try again.');
            }
        });

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('editRoomModal');
            if (event.target === modal) {
                closeEditModal();
            }
        }

        async function editRoom(roomType) {
            // Get current room data from the displayed cards
            const roomCard = document.querySelector(`[data-room-type="${roomType}"]`);
            if (!roomCard) {
                alert('Room data not found');
                return;
            }
            
            // Extract current values from the card
            const priceElement = roomCard.querySelector('p');
            const currentPrice = parseFloat(priceElement.textContent.replace('Price: $', '').replace('/night', '').replace(',', ''));
            
            // Create a comprehensive form for editing all values
            const newPrice = prompt(`Enter new price for ${roomType} (current: $${currentPrice.toLocaleString()}):`, currentPrice);
            if (newPrice === null) return;
            
            const newTotalRooms = prompt(`Enter new total rooms for ${roomType} (current: 25):`, 25);
            if (newTotalRooms === null) return;
            
            const newAvailableRooms = prompt(`Enter new available rooms for ${roomType} (current: 5):`, 5);
            if (newAvailableRooms === null) return;
            
            const newFloor = prompt(`Enter new floor number for ${roomType} (current: 1):`, 1);
            if (newFloor === null) return;
            
            const statusOptions = ['Available', 'Fully Booked', 'Maintenance'];
            const newStatus = prompt(`Enter new status for ${roomType} (0=Available, 1=Fully Booked, 2=Maintenance) (current: 0):`, 0);
            if (newStatus === null) return;
            
            const newDescription = prompt(`Enter new description for ${roomType} (optional):`, '');
            
            try {
                const response = await fetch('Backend/Admin/edit_room.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        room_type: roomType,
                        base_price: parseFloat(newPrice),
                        total_rooms: parseInt(newTotalRooms),
                        available_rooms: parseInt(newAvailableRooms),
                        floor_number: parseInt(newFloor),
                        status: statusOptions[parseInt(newStatus)],
                        description: newDescription
                    })
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    alert('Room updated successfully!');
                    // Reload the page to refresh data
                    location.reload();
                } else {
                    alert('Error: ' + result.message);
                }
            } catch (error) {
                console.error('Error updating room:', error);
                alert('Failed to update room. Please try again.');
            }
        }

        async function deleteRoom(roomType) {
            if (confirm(`Are you sure you want to delete the room type "${roomType}"? This action cannot be undone.`)) {
                try {
                    const response = await fetch('Backend/Admin/delete_room.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            room_type: roomType
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        alert('Room type deleted successfully!');
                        // Reload the page to refresh data
                        location.reload();
                    } else {
                        alert('Error: ' + result.message);
                    }
                } catch (error) {
                    console.error('Error deleting room:', error);
                    alert('Failed to delete room. Please try again.');
                }
            }
        }
    </script>
</body>
</html> 